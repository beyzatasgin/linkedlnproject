{% extends "base.html" %}
{% block title %}Bağlantılar - LinkedIn Klonu{% endblock %}
{% block content %}
<h1 style="margin-top:0">Bağlantılar</h1>

<form method="get" style="margin:16px 0;display:flex;gap:8px;align-items:center;">
  <input
    type="text"
    name="q"
    placeholder="Kullanıcı ara..."
    value="{{ query }}"
    style="flex:1;padding:8px 12px;border-radius:999px;border:1px solid var(--border);"
  />
  <button type="submit" class="btn btn-small">Ara</button>
</form>

{% if search_results %}
  <div class="card" style="margin-bottom:16px;">
    <h3 style="margin-top:0">Arama Sonuçları</h3>
    <ul style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px">
      {% for user in search_results %}
        <li style="display:flex;justify-content:space-between;align-items:center;border:1px solid var(--border);border-radius:8px;padding:8px 10px;">
          <div style="display:flex;flex-direction:column;">
            <a href="{% url 'profile_detail' user.username %}">@{{ user.username }}</a>
            {% if user.get_full_name %}
              <span style="font-size:12px;color:var(--muted);">{{ user.get_full_name }}</span>
            {% endif %}
          </div>
          <a class="btn btn-small" href="{% url 'connection_send' user.username %}">Bağlantı isteği gönder</a>
        </li>
      {% endfor %}
    </ul>
  </div>
{% elif query %}
  <div class="card" style="margin-bottom:16px;">
    <p style="margin:0;color:var(--muted);">\"{{ query }}\" için kullanıcı bulunamadı.</p>
  </div>
{% endif %}

<div class="grid-2">
  <div class="card">
    <h3 style="margin-top:0">Gelen İstekler</h3>
    <ul style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px">
      {% for c in received %}
        <li style="display:flex;justify-content:space-between;align-items:center;border:1px solid var(--border);border-radius:8px;padding:8px 10px;">
          <a href="{% url 'profile_detail' c.from_user.username %}">{{ c.from_user.username }}</a>
          <a class="btn btn-small" href="{% url 'connection_accept' c.from_user.username %}">Kabul Et</a>
        </li>
      {% empty %}
        <li>Bekleyen istek yok.</li>
      {% endfor %}
    </ul>
  </div>

  <div class="card">
    <h3 style="margin-top:0">Gönderilen İstekler</h3>
    <ul style="list-style:none;padding:0;margin:0;display:flex;flex-direction:column;gap:8px">
      {% for c in sent %}
        <li style="display:flex;justify-content:space-between;align-items:center;border:1px solid var(--border);border-radius:8px;padding:8px 10px;">
          <a href="{% url 'profile_detail' c.to_user.username %}">{{ c.to_user.username }}</a>
          <span style="color:var(--muted);font-size:12px">Beklemede</span>
        </li>
      {% empty %}
        <li>Gönderilen istek yok.</li>
      {% endfor %}
    </ul>
  </div>
</div>

<div class="card">
  <h3 style="margin-top:0">Bağlantı Listesi</h3>
  <ul style="list-style:none;padding:0;margin:0;display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:10px">
    {% for c in accepted_from %}
      <li style="border:1px solid var(--border);border-radius:8px;padding:8px 10px"><a href="{% url 'profile_detail' c.to_user.username %}">{{ c.to_user.username }}</a></li>
    {% endfor %}
    {% for c in accepted_to %}
      <li style="border:1px solid var(--border);border-radius:8px;padding:8px 10px"><a href="{% url 'profile_detail' c.from_user.username %}">{{ c.from_user.username }}</a></li>
    {% empty %}
      <li>Bağlantı yok.</li>
    {% endfor %}
  </ul>
</div>
{% endblock %}


